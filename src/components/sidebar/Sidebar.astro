---
import Sitemap from './Sitemap.astro'
import { Icon } from 'astro-icon/components'
import { resetCounters } from '@/utils/sidebarCountStore'

resetCounters()
---

<input id="sidebar-toggle" type="checkbox" class="hidden" transition:persist />
<nav
  id="sidebar"
  class="text-zinc-950 bg-zinc-300
  border-r-2 border-zinc-900
  text-sm font-medium flex-shrink-0"
  transition:persist
>
  <label
    for="sidebar-toggle"
    class="flex items-center justify-end py-1 px-2
    text-right text-3xl select-none cursor-pointer
    hover:bg-blue-500"
  >
    <Icon name="ic:sharp-menu" />
  </label>

  <div id="sidebar-content" class="pl-4 py-1 min-h-full">
    <Sitemap />
  </div>
</nav>

<style is:global>
  :root {
    --collapsed-width: 3rem;
    --expanded-width: 20rem;
    --sidebar-width: var(--expanded-width);
  }

  #sidebar {
    min-width: var(--collapsed-width);
  }

  #sidebar-content {
    width: var(--sidebar-width);
    display: block;
  }
  #sidebar-toggle:checked + #sidebar > #sidebar-content {
    display: none;
  }

  #sidebar-toggle:checked ~ #content {
    --sidebar-width: var(--collapsed-width);
  }

  #sidebar-toggle:not(:checked) + nav > label:not(:hover) {
    @apply bg-zinc-400;
  }
</style>

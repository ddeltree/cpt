---
import Sitemap from './Sitemap.astro'
import { Icon } from 'astro-icon/components'
---

<input id="sidebar-toggle" type="checkbox" class="hidden" transition:persist />
<div
  id="sidebar-container"
  class="relative flex-shrink-0
        overflow-y-auto overflow-x-hidden
        text-zinc-950 bg-zinc-300 transition-all"
>
  <nav
    id="sidebar"
    class="text-sm font-medium
  absolute bottom-0 top-0"
    transition:persist
  >
    <label
      id="sidebar-hamburger"
      for="sidebar-toggle"
      class="fixed z-10
        flex items-center justify-end
        px-3
        text-right text-2xl
        select-none cursor-pointer
        border-b-2 border-zinc-200
        bg-zinc-300 hover:bg-blue-500"
    >
      <Icon name="ic:sharp-menu" />
    </label>

    <div id="sidebar-content" class="pl-4 py-1">
      <Sitemap />
    </div>
  </nav>
</div>

<style is:global>
  :root {
    --collapsed-width: 3rem;
    --expanded-width: 20rem;
    --sidebar-hamburger-height: 2rem;
    --sidebar-width: var(--expanded-width);
  }

  #sidebar {
    min-width: var(--collapsed-width);
    margin-top: var(--header-height);
  }
  #sidebar-hamburger {
    height: var(--sidebar-hamburger-height);
    width: var(--sidebar-width);
  }

  #sidebar-container {
    width: var(--sidebar-width);
  }
  #sidebar-content {
    margin-top: var(--sidebar-hamburger-height);
    width: var(--sidebar-width);
    display: block;
  }
  #sidebar-toggle:checked + #sidebar-container > #sidebar > #sidebar-content {
    display: none;
  }

  #sidebar-toggle:checked ~ #sidebar-container ~ #content,
  #sidebar-toggle:checked ~ #sidebar-container {
    --sidebar-width: var(--collapsed-width);
  }

  #sidebar-toggle:not(:checked) + nav > label:not(:hover) {
    @apply bg-zinc-400;
  }
</style>
